<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Processo Ágil: pleshw</title>
  <link rel="stylesheet" href="index.css">

  <link rel="stylesheet" href="vortext.css">
</head>

<body>

  <main>

    <section class="scene">
      <h5>Cena 1</h5>
      <div class="content">
        <h1>Projeto Boom</h1>
      </div>
    </section>
    <section class="scene">
      <h5>Cena 1</h5>
      <div class="content">
        <h1>Sabemos Como seu tempo é importante e deve ser valorizado...</h1>

      </div>
    </section>
    <section class="scene">
      <h5>Cena 3</h5>
      <div class="content">
        <div class="tempo-economizado">
          <h1 class="dias-economizados"></h1>
          <h1 class="horas-economizados"></h1>
          <h1 class="minutos-economizados"></h1>
          <h1 class="segundos-economizados"></h1>
        </div>
        <div class="w-50 h-100 flex-center">
          <div class="w-50 flex-center flex-col h-100">
            <h2>Esse é o tempo que você economizou por utilizar nosso sistema. </h2>
          </div>

        </div>
      </div>
    </section>
    <section class="scene">
      <h5>Cena 3</h5>
      <div class="content">
        <div class="pen">
          <div class="stage">
            <div class="vortext">
              <div class="vortextRibbon">Barcelona. Paris. London. Berlin. Stockholm.</div>
            </div>
            <div class="vortext">
              <div class="vortextRibbon">Barcelona. Paris. London. Berlin. Stockholm.</div>
            </div>
            <div class="vortext">
              <div class="vortextRibbon">Barcelona. Paris. London. Berlin. Stockholm.</div>
            </div>
            <div class="vortext">
              <div class="vortextRibbon">Barcelona. Paris. London. Berlin. Stockholm.</div>
            </div>
            <div class="vortext">
              <div class="vortextRibbon">Barcelona. Paris. London. Berlin. Stockholm.</div>
            </div>
            <div class="vortext">
              <div class="vortextRibbon">Cairo. Nairobi. Johannesburg. Tel Aviv. Dubai.</div>
            </div>
            <div class="vortext">
              <div class="vortextRibbon">Mumbai. Bangkok. Singapore. Hanoi. Jakarta.</div>
            </div>
            <div class="vortext">
              <div class="vortextRibbon">Shanghai. Taipei. Tokyo. Melbourne. Auckland.</div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="scene">
      <h5>Cena 4</h5>
      <div class="content">
        <div class="background-content">
          <h1 class="spotlight" data-text="DESTAQUE">DESTAQUE</h1>
        </div>
      </div>
    </section>
    <section class="scene">
      <h5>Cena 5</h5>
    </section>
    <section class="scene">
      <h5>Cena 6</h5>
    </section>
    <section class="scene">
      <h5>Cena 7</h5>
    </section>
    <section class="scene">
      <h5>Cena 8</h5>
    </section>
    <section class="scene">
      <h5>Cena 9</h5>
    </section>

    <section class="scene">
      <h5>Cena 10</h5>
      <div class="content">
        <div class="background-content">
          <h1 class="spotlight" data-text="DESTAQUE">DESTAQUE</h1>
        </div>
      </div>
    </section>
    <section class="scene">
      <h5>Cena 11</h5>
    </section>

    <div class="progress"></div>
  </main>

  <!-- JavaScript Bundle with Popper -->
  <script defer src="build/anime.min.js"></script>
  <script defer src="build/typed.min.js"></script>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="https://unpkg.com/topojson@3"></script>
  <script defer src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script defer src="//cdnjs.cloudflare.com/ajax/libs/velocity/1.2.3/velocity.min.js"></script>
  <script defer src="//cdnjs.cloudflare.com/ajax/libs/gsap/3.8.0/gsap.min.js"></script>
  <script defer src="//cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/ScrollMagic.min.js"></script>
  <script defer src="//cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/plugins/animation.gsap.js"></script>
  <script defer src="//cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/plugins/animation.velocity.js"></script>
  <script defer src="//cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/plugins/debug.addIndicators.min.js"></script>

  <script type="module" src="build/utils.js"></script>
  <script type="module" src="build/CSSAttributes.js"></script>
  <script type="module" src="build/CSSEditor.js"></script>
  <script type="module">
    import { CSSAttributes } from './build/CSSAttributes.js';
    import { CSSEditor } from './build/CSSEditor.js';
    import { SceneScaffold } from './build/Scene/SceneScaffold.js';
    import { Scene } from './build/Scene/Scene.js';
    import { SceneView } from './build/Scene/SceneView.js';
    import { throttle, zeroBefore, animacaoBarraProgresso } from './build/utils.js';

    window.addEventListener('load', () => {

      const scrollMagicIndicatorsController = new ScrollMagic.Controller();

      document.querySelectorAll('.scene').forEach((item, index) => {
        const _tmpSceneScaffold = new SceneScaffold(item);
        const _tmpScene = new Scene(_tmpSceneScaffold);
        SceneView.scenes.push(_tmpScene);

        const scrollMagicSceneConfig = {
          triggerElement: SceneView.last().scaffold.element,
          duration: SceneView.last().scaffold.element.clientHeight,
          triggerHook: .5
        }

        SceneView.last().scrollMagicScene = new ScrollMagic.Scene(scrollMagicSceneConfig)
          .addTo(scrollMagicIndicatorsController)
          .on('enter', () => {
            console.log('Você entrou na cena ' + SceneView.last().id)
            _tmpScene.render();
          });
      })

      SceneView.createControllers();

      const progressDivCss = new CSSAttributes({
        width: `100%`,
        height: `10px`,
        position: 'fixed',
        isGradient: true,
        gradientRotation: '230deg',
        transition: 'all .3s',
        x: `0px`,
        top: `calc(100% - 10px)`,
        isProgressBar: true,
        progressRotation: '90deg',
        progress: 0,
        progressColor: 'darkblue',
        progressBackground: 'transparent'
      });

      document.getElementById('prevScene').addEventListener('click', evt => {
        SceneView.prev();
      })


      document.getElementById('nextScene').addEventListener('click', evt => {
        SceneView.next();
      })

      const progressBar = document.querySelector('.progress');

      CSSEditor.from(progressBar, progressDivCss)

      window.addEventListener('scroll', function (evt) {
        throttle(() => {
          const posicaoDestino = (this.scrollY / (document.body.scrollHeight - window.innerHeight)) * 100;
          animacaoBarraProgresso(progressBar, progressDivCss, posicaoDestino, 'scrollProgress');
        }, 100, 'scrollProgress')
      });

      let ticking = false;
      window.addEventListener('wheel', function (evt) {
        throttle(() => {
          window.requestAnimationFrame(() => {
            if (Math.sign(evt.deltaY) > 0) {
              SceneView.next();
            } else {
              SceneView.prev();
            }
          })
        }, 500, 'wheelNextScene')
      });

      SceneView.scrollToScene(0);

      SceneView.get(3).animationCallback = () => {
        setVortextStyles();
        renderVortext();
        setTimeout(animateVortext);
      }

      SceneView.get(2).animationCallback = () => {
        var diasEl = document.querySelector('.dias-economizados');
        var horasEl = document.querySelector('.horas-economizados');
        var minutosEl = document.querySelector('.minutos-economizados');
        var segundosEl = document.querySelector('.segundos-economizados');

        var customerTime = {
          saved: 0
        }

        anime({
          targets: customerTime,
          saved: 100000,
          round: 1,
          delay: 1000,
          duration: 7500,
          easing: 'easeInOutExpo',
          update: function () {
            const strDate1DayOver = new Date(customerTime.saved * 1000)
              .toISOString()
              .substr(9, 10)
              .replace('T', ':');

            const strDateSplitted = strDate1DayOver.split(':')
            let dias = +strDateSplitted[0] - 1;
            let horas = +strDateSplitted[1];
            let minutos = +strDateSplitted[2];
            let segundos = +strDateSplitted[3];

            let textoDias = dias > 0 ? `${ zeroBefore(dias) } ${ dias > 1 ? 'dias' : 'dia' }` : '';
            let textoHoras = textoDias || horas > 0 ? `${ zeroBefore(horas) } horas` : '';
            let textoMinutos = textoHoras || minutos > 0 ? `${ zeroBefore(minutos) } minutos` : '';
            let textoSegundos = textoMinutos || segundos > 0 ? `${ zeroBefore(segundos) } segundos` : '';

            diasEl.innerHTML = `${ textoDias }`;
            horasEl.innerHTML = `${ textoHoras }`;
            minutosEl.innerHTML = `${ textoMinutos }`;
            segundosEl.innerHTML = `${ textoSegundos }`;
          }
        });
      }

    })
  </script>

  <script defer src="vortext.js"></script>
</body>

</html>